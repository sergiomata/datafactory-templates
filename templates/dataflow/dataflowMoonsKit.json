{
	"name": "dataflowMoonsKit",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DestinationDataLakeV1Moonskit",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DestinationDataLakeV1Moonskit",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "Aggregate1"
				}
			],
			"script": "source(output(\n\t\t{_id} as string,\n\t\tOwner as (name as string, id as string, email as string),\n\t\tLast_Activity_Time as string,\n\t\tModified_By as (name as string, id as string, email as string),\n\t\tModified_Time as string,\n\t\tCreated_Time as string,\n\t\tRelated_Deal as (name as string, id as string),\n\t\tProduction_Trigger_Date as string,\n\t\tProduction_Promise_Date as string,\n\t\tCreated_By as (name as string, id as string, email as string),\n\t\tMoonsKit_Owner as ({} as string),\n\t\tMoons_Kit_Id as string,\n\t\tProduction_Trigger_Moons_Kit as boolean,\n\t\tName as string,\n\t\tCurrency as string,\n\t\tMoons_Kit_Stage as string,\n\t\tCustomerId as string,\n\t\tPatient as string,\n\t\t{_created_at} as string,\n\t\t{_updated_at} as string,\n\t\tSended_To_Customer_Care as boolean,\n\t\tProduced as boolean,\n\t\tReturn_Kit_Day as string,\n\t\tCorrect_Printing as string,\n\t\tSession_Owner as string,\n\t\tShipping_Day as string,\n\t\tReception_Day as string,\n\t\tSession_Correct_Printing as string,\n\t\tBad_Printing_Reason as string,\n\t\tBad_Session_Correct_Printing_Reason as string,\n\t\tSession_Date as string,\n\t\tReturn_Number as string,\n\t\tShipping_Tracking_URL as string,\n\t\tReprinted as boolean,\n\t\tShipping_Number as string,\n\t\tReturn_Kit_Tracking_URL as string,\n\t\tIncidence_Reason as string,\n\t\tAppointment_Date as string,\n\t\tAppointment_Page as string,\n\t\tAppointment_Status as string,\n\t\tLocation as string,\n\t\tAppointment_Id as string,\n\t\tCalendar as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false) ~> source1\nsource1 aggregate(groupBy(Last_Activity_Time),\n\tLast_Activity_Time_Timestamp = toTimestamp(toInteger(toString('Last_Activity_Time'))*1000l,'yyyy-MM-dd HH:mm:ss')) ~> Aggregate1\nAggregate1 sink(input(\n\t\t{_id} as string,\n\t\tOwner as (name as string, id as string, email as string),\n\t\tLast_Activity_Time as string,\n\t\tModified_By as (name as string, id as string, email as string),\n\t\tModified_Time as string,\n\t\tCreated_Time as string,\n\t\tRelated_Deal as (name as string, id as string),\n\t\tProduction_Trigger_Date as string,\n\t\tProduction_Promise_Date as string,\n\t\tCreated_By as (name as string, id as string, email as string),\n\t\tMoonsKit_Owner as ({} as string),\n\t\tMoons_Kit_Id as string,\n\t\tProduction_Trigger_Moons_Kit as boolean,\n\t\tName as string,\n\t\tCurrency as string,\n\t\tMoons_Kit_Stage as string,\n\t\tCustomerId as string,\n\t\tPatient as string,\n\t\t{_created_at} as string,\n\t\t{_updated_at} as string,\n\t\tSended_To_Customer_Care as boolean,\n\t\tProduced as boolean,\n\t\tReturn_Kit_Day as string,\n\t\tCorrect_Printing as string,\n\t\tSession_Owner as string,\n\t\tShipping_Day as string,\n\t\tReception_Day as string,\n\t\tSession_Correct_Printing as string,\n\t\tBad_Printing_Reason as string,\n\t\tBad_Session_Correct_Printing_Reason as string,\n\t\tSession_Date as string,\n\t\tReturn_Number as string,\n\t\tShipping_Tracking_URL as string,\n\t\tReprinted as boolean,\n\t\tShipping_Number as string,\n\t\tReturn_Kit_Tracking_URL as string,\n\t\tIncidence_Reason as string,\n\t\tAppointment_Date as string,\n\t\tAppointment_Page as string,\n\t\tAppointment_Status as string,\n\t\tLocation as string,\n\t\tAppointment_Id as string,\n\t\tCalendar as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink1"
		}
	}
}